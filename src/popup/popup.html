<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Snip & Ask</title>
  <link rel="stylesheet" href="popup.css">
</head>

<body>

  <!-- Main Content -->
  <div id="mainView">
    <div class="header">
      <h2>‚ö° Snip & Ask</h2>
    </div>

    <div id="messageContainer" class="hidden" style="color: #4caf50; text-align: center; margin-bottom: 10px;">
      Settings saved!
    </div>

    <!-- Provider Hint (shown if only Groq enabled) -->
    <div id="providerHint" class="provider-hint hidden">
      üí° <a id="enableMoreProviders">Enable more providers</a> like Google, OpenRouter, or Ollama in settings.
    </div>

    <!-- API Keys (collapsed) -->
    <details id="apiKeysSection" style="margin-bottom: 12px;">
      <summary
        style="cursor: pointer; font-weight: 600; color: #ccc; font-size: 12px; padding: 8px 0; user-select: none;">
        üîê API Keys <span style="color: #666; font-size: 10px;">(click to expand)</span>
      </summary>
      <div
        style="padding: 10px; background: #252526; border-radius: 0 0 6px 6px; border: 1px solid #333; border-top: none;">
        <div style="font-size: 10px; color: #888; margin-bottom: 8px;">
          üîí Keys are stored locally in your browser only.
        </div>
        <div id="apiKeyInputs">
          <!-- Dynamically populated based on enabled providers -->
        </div>
        <div style="font-size: 10px; color: #888; margin-top: 8px; padding-top: 8px; border-top: 1px solid #333;">
          üìÅ <strong style="color: #ccc;">PDF Snipping:</strong>
          <a href="#" id="openExtSettings" style="color: #f55036;">Enable file access</a>
        </div>
      </div>
    </details>

    <label for="modelSelect">AI Model</label>
    <select id="modelSelect">
      <!-- Dynamically populated based on enabled providers -->
    </select>

    <label for="modeSelect">Interaction Mode</label>
    <select id="modeSelect">
      <!-- Dynamically populated from storage -->
    </select>

    <div id="customPromptContainer" class="hidden">
      <label for="customPromptText">Your System Instruction:</label>
      <textarea id="customPromptText" rows="3" placeholder="Ex: You are a helpful assistant..."></textarea>
    </div>

    <button id="snipBtn">Snip Screen</button>

    <div class="footer">
      <span class="footer-text">v4.0 ‚Ä¢ Customizable</span>
      <button class="settings-btn" id="openSettingsBtn" title="Settings">‚öôÔ∏è Settings</button>
    </div>
  </div>

  <!-- Slide-out Settings Panel -->
  <div class="settings-panel" id="settingsPanel">
    <div class="settings-header">
      <h3>‚öôÔ∏è Settings</h3>
      <button class="close-btn" id="closeSettingsBtn">‚úï</button>
    </div>

    <div class="tabs">
      <button class="tab-btn active" data-tab="providers">Providers</button>
      <button class="tab-btn" data-tab="models">Models</button>
      <button class="tab-btn" data-tab="modes">Modes</button>
    </div>

    <!-- Providers Tab -->
    <div class="tab-content active" id="providersTab">
      <div style="font-size: 11px; color: #888; margin-bottom: 12px;">
        Enable/disable AI providers. Hidden providers' API keys are deleted after 7 days.
      </div>

      <div
        style="font-size: 11px; color: #666; margin-bottom: 12px; padding: 8px; background: #252526; border-radius: 4px; border-left: 2px solid #f55036;">
        ‚å®Ô∏è <strong style="color: #ccc;">Tip:</strong> Set a keyboard shortcut at
        <a href="#" id="openShortcutsLink" style="color: #f55036;">chrome://extensions/shortcuts</a>
      </div>

      <div class="provider-item">
        <div class="provider-info">
          <span class="provider-icon">üöÄ</span>
          <span class="provider-name">Groq</span>
        </div>
        <label class="toggle">
          <input type="checkbox" id="providerGroq" checked>
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div class="provider-item">
        <div class="provider-info">
          <span class="provider-icon">‚ú®</span>
          <span class="provider-name">Google (Gemini)</span>
        </div>
        <label class="toggle">
          <input type="checkbox" id="providerGoogle">
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div class="provider-item">
        <div class="provider-info">
          <span class="provider-icon">üåê</span>
          <span class="provider-name">OpenRouter</span>
        </div>
        <label class="toggle">
          <input type="checkbox" id="providerOpenRouter">
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div class="provider-item">
        <div class="provider-info">
          <span class="provider-icon">ü¶ô</span>
          <span class="provider-name">Ollama (Local)</span>
        </div>
        <label class="toggle">
          <input type="checkbox" id="providerOllama">
          <span class="toggle-slider"></span>
        </label>
      </div>

      <div style="margin-top: 16px; padding-top: 12px; border-top: 1px solid #333;">
        <div style="font-size: 11px; color: #888; margin-bottom: 8px;">Compare Windows</div>
        <div style="display: flex; align-items: center; gap: 10px;">
          <span style="font-size: 12px; color: #ccc;">Max comparison windows:</span>
          <select id="maxCompareWindows"
            style="background: #252526; color: #ccc; border: 1px solid #444; border-radius: 4px; padding: 4px 8px; font-size: 12px;">
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4" selected>4</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Models Tab -->
    <div class="tab-content" id="modelsTab">
      <div style="font-size: 11px; color: #888; margin-bottom: 12px;">
        Enable/disable individual AI models. Disabled models won't appear in the model selector.
      </div>

      <div id="modelsList">
        <!-- Dynamically populated -->
      </div>
    </div>

    <!-- Modes Tab -->
    <div class="tab-content" id="modesTab">
      <div style="font-size: 11px; color: #888; margin-bottom: 12px;">
        Customize interaction modes with your own prompts.
      </div>

      <div id="modesList">
        <!-- Dynamically populated -->
      </div>

      <button class="add-mode-btn" id="addModeBtn">+ Add Custom Mode</button>

      <!-- Mode Editor -->
      <div class="mode-editor" id="modeEditor">
        <div class="input-with-counter">
          <input type="text" id="modeNameInput" placeholder="Mode name (e.g., Summarize)" maxlength="50">
          <span class="char-counter" id="nameCounter">0/50</span>
        </div>
        <div class="input-with-counter">
          <textarea id="modePromptInput" rows="4" placeholder="System prompt..." maxlength="2000"></textarea>
          <span class="char-counter" id="promptCounter">0/2000</span>
        </div>
        <div class="mode-editor-actions">
          <button class="cancel-btn" id="cancelModeBtn">Cancel</button>
          <button class="save-btn" id="saveModeBtn">Save</button>
        </div>
      </div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>

</html>